<div *ngIf="loading" class="text-center py-5">
  <div class="spinner-border text-warning" role="status"></div>
</div>

<div *ngIf="error" class="alert alert-danger text-center">
  {{ error }}
</div>

<div *ngIf="product" class="container py-5">
  <div class="row g-4">
    <!-- Product Images -->
    <div class="col-md-6 text-center">
      <!-- Main Image -->
      <img
        [src]="selectedImage || product.images[0]"
        [alt]="product.name"
        class="img-fluid rounded shadow-sm mb-3"
        style="max-height: 400px; object-fit: cover;"
      />

      <!-- Thumbnails -->
      <div class="d-flex justify-content-center gap-2">
        <img
          *ngFor="let img of product.images"
          [src]="img"
          class="img-thumbnail"
          style="width: 80px; height: 80px; object-fit: cover; cursor: pointer;"
          (click)="selectedImage = img"
        />
      </div>
    </div>

    <!-- Product Info -->
    <div class="col-md-6">
      <h2 class="fw-bold">{{ product.name }}</h2>
      <p class="text-muted mb-1"><strong>Brand:</strong> {{ product.brand }}</p>
      <p class="text-muted"><strong>Category:</strong> {{ product.categoryId?.name }}</p>

      <!-- Rating -->
      <div class="d-flex align-items-center mb-3">
        <ng-container *ngFor="let star of starsArray">
          <i *ngIf="star === 'full'" class="bi bi-star-fill text-warning"></i>
          <i *ngIf="star === 'half'" class="bi bi-star-half text-warning"></i>
          <i *ngIf="star === 'empty'" class="bi bi-star text-warning"></i>
        </ng-container>
        <span class="ms-2 small text-muted">
          ({{ product.rating | number:'1.1-1' }} / 5 from {{ product.numReviews }} reviews)
        </span>
      </div>

      <!-- Price and Discount -->
      <div class="mb-3">
        <h4 class="text-success fw-semibold">
          ₹{{ product.price | number }}
          <small class="text-muted text-decoration-line-through ms-2">
            ₹{{ product.price + (product.price * product.discount / 100) | number }}
          </small>
        </h4>
        <span class="badge bg-danger">{{ product.discount }}% OFF</span>
      </div>

      <!-- Stock Info -->
      <p>
        <strong>Availability:</strong>
        <span [class.text-success]="product.stock > 0" [class.text-danger]="product.stock === 0">
          {{ product.stock > 0 ? product.stock + ' in stock' : 'Out of stock' }}
        </span>
      </p>

      <!-- Attributes -->
      <div class="border rounded p-3 mb-3 bg-light">
        <h6 class="fw-bold mb-2">Product Attributes</h6>
        <ul class="list-unstyled mb-0">
          <li><strong>Color: </strong> <span [style.color]="product.attributes?.color">{{ product.attributes?.color }}</span></li>
          <li><strong>Material:</strong> {{ product.attributes?.material }}</li>
          <li><strong>Warranty:</strong> {{ product.attributes?.warranty }}</li>
        </ul>
      </div>

      <!-- Description -->
      <div class="mb-3">
        <h6 class="fw-bold">Description</h6>
        <p class="text-secondary">{{ product.description }}</p>
      </div>

      <!-- Action Buttons -->
      <div class="mt-4 d-flex gap-3">
        <button class="btn btn-warning px-4">Add to Cart</button>
        <button class="btn btn-dark px-4">Buy Now</button>
      </div>

      <!-- Back Button -->
      <a routerLink="/" class="btn btn-link mt-3 text-decoration-none">← Back to Products</a>
    </div>
  </div>

  <!-- Optional Footer Info -->
  <div class="text-muted small text-center mt-4">
    <p>Created: {{ product.createdAt | date:'mediumDate' }} • Updated: {{ product.updatedAt | date:'mediumDate' }}</p>
  </div>
</div>
